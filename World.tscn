[gd_scene load_steps=18 format=2]

[ext_resource path="res://Player/Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://City/Tree.tscn" type="PackedScene" id=2]
[ext_resource path="res://Sprites/Houses/House.tscn" type="PackedScene" id=3]
[ext_resource path="res://City/CityStreetLayout.tscn" type="PackedScene" id=4]
[ext_resource path="res://NPCs/BasicBoid.tscn" type="PackedScene" id=5]
[ext_resource path="res://Systems/MusicManager.gd" type="Script" id=6]
[ext_resource path="res://Audio/100BPM house free.ogg" type="AudioStream" id=7]
[ext_resource path="res://Sprites/UI/input_button.png" type="Texture" id=8]
[ext_resource path="res://UI/BeatIndicatorUI.gd" type="Script" id=9]
[ext_resource path="res://World.gd" type="Script" id=10]
[ext_resource path="res://Systems/InputManager.gd" type="Script" id=11]
[ext_resource path="res://UI/InputChainUI/InputChain.gd" type="Script" id=12]
[ext_resource path="res://NPCs/Citizen/BystanderGroup.gd" type="Script" id=13]

[sub_resource type="PlaneMesh" id=1]
size = Vector2( 40, 40 )

[sub_resource type="SpatialMaterial" id=2]
albedo_color = Color( 0.572549, 0.545098, 0.545098, 1 )

[sub_resource type="Environment" id=3]
background_mode = 3
background_color = Color( 0.635294, 0.607843, 0.537255, 1 )
dof_blur_far_enabled = true
dof_blur_far_distance = 6.0
dof_blur_far_amount = 0.15
dof_blur_far_quality = 2
dof_blur_near_enabled = true
dof_blur_near_distance = 4.0
dof_blur_near_transition = 0.32
dof_blur_near_amount = 0.15
dof_blur_near_quality = 2

[sub_resource type="CylinderShape" id=4]

[node name="World" type="Spatial"]
script = ExtResource( 10 )

[node name="Ground" type="MeshInstance" parent="."]
layers = 4
mesh = SubResource( 1 )
material/0 = SubResource( 2 )

[node name="Player" parent="." instance=ExtResource( 1 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -0.000177383, 0.0273861, -0.118153 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 3 )

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.703792, -0.443073, 0.555305, 0, 0.781673, 0.623689, -0.710407, -0.438947, 0.550135, 0, 1.46664, 2.28217 )
light_energy = 1.16
shadow_enabled = true
shadow_bias = 0.01

[node name="GridMap" parent="." instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.04535, -0.182955 )
collision_layer = 4
data = {
"cells": PoolIntArray( 0, 0, 1441792, 1, 0, 1441792, 2, 0, 1441792, 3, 0, 1441792, 4, 0, -2146041856, 5, 0, -1609170944, 6, 0, -2146041856, 7, 0, 1441792, 65528, 0, 1441792, 65529, 0, 1441792, 65530, 0, 1441792, 65531, 0, 1441792, 65532, 0, 1441792, 65533, 0, 1441792, 65534, 0, 1441792, 65535, 0, 1441792 )
}

[node name="Trees" type="Spatial" parent="."]

[node name="Tree" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.635882, 0, -0.658702 )

[node name="Tree2" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.73448, 0, -0.658702 )

[node name="Tree3" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.73448, 0, 1.6092 )

[node name="Tree11" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.95259, 0, 3.61292 )

[node name="Tree12" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.45337, 0, 2.62036 )

[node name="Tree15" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.102355, 0, 3.27503 )

[node name="Tree16" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.803108, 0, 2.93141 )

[node name="Tree17" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.343904, 0, 2.31205 )

[node name="Tree13" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.816257, 0, 3.34432 )

[node name="Tree14" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.96796, -0.00626564, 3.63132 )

[node name="Tree7" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.12163, 0, -4.68467 )

[node name="Tree8" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.173404, 0, -4.68467 )

[node name="Tree9" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.24284, 0, -4.68467 )

[node name="Tree10" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.28786, 0, -4.68467 )

[node name="Tree4" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.619599, 0, 1.60246 )

[node name="Tree5" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.73449, 0, 1.64712 )

[node name="Tree6" parent="Trees" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.73449, 0, -0.737139 )

[node name="Houses" type="Spatial" parent="."]

[node name="House" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -0.557614, 0.495138, -0.296317 )

[node name="House2" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 1.79845, 0.495138, -0.296317 )

[node name="House3" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -2.92008, 0.495138, -0.296317 )

[node name="House4" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -2.92008, 0.495138, 4.21646 )

[node name="House5" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 2.08698, 0.489737, 4.19828 )

[node name="House6" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 2.07953, 0.495138, -4.58548 )

[node name="House9" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 5.77307, 0.495138, -4.58548 )

[node name="House10" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, 9.09708, 0.495138, -4.58548 )

[node name="House11" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -8.12126, 0.495138, -4.58548 )

[node name="House12" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -5.98874, 0.495138, -4.58548 )

[node name="House7" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -0.885214, 0.495138, -4.58548 )

[node name="House8" parent="Houses" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 0.707107, 0.707107, 0, -0.707107, 0.707107, -3.49127, 0.495138, -4.58548 )

[node name="Crowd" type="Spatial" parent="."]

[node name="BoidTest" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.721889, 0, 0.355373 )

[node name="BoidTest2" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.66803, 0, 0.225206 )

[node name="BoidTest3" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.37135, 0, 0 )

[node name="BoidTest4" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -3.58599, 0, 0 )

[node name="BoidTest7" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -3.1909, 0, 1.19599 )

[node name="BoidTest8" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.49784, 0, 1.19599 )

[node name="BoidTest9" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.49784, 0, 2.35612 )

[node name="BoidTest10" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.62618, 0, -0.91405 )

[node name="BoidTest11" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.8948, 0, -0.0775683 )

[node name="BoidTest12" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.45023, 0, 1.42653 )

[node name="BoidTest13" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.1277, 0, 1.2361 )

[node name="BoidTest14" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 5.2498, 0, 0.574223 )

[node name="BoidTest15" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 1.08155, 0, 1.11336 )

[node name="BoidTest5" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.13572, 0, 0.519318 )

[node name="BoidTest6" parent="Crowd" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4.33805, 0, 0.806026 )

[node name="Bystanders" type="Spatial" parent="."]
visible = false

[node name="Group" type="Spatial" parent="Bystanders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 5.62972, 0, -1.30304 )
visible = false
script = ExtResource( 13 )

[node name="BoidTest" parent="Bystanders/Group" instance=ExtResource( 5 )]

[node name="BoidTest2" parent="Bystanders/Group" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.198472, 0, 0.225632 )

[node name="Area" type="Area" parent="Bystanders/Group"]
collision_layer = 2

[node name="CollisionShape" type="CollisionShape" parent="Bystanders/Group/Area"]
shape = SubResource( 4 )

[node name="BeatManager" type="Spatial" parent="."]
script = ExtResource( 6 )

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="BeatManager"]
stream = ExtResource( 7 )
volume_db = -10.097

[node name="InputManager" type="Spatial" parent="."]
script = ExtResource( 11 )
beat_manager_node = NodePath("../BeatManager")

[node name="UILayer" type="CanvasLayer" parent="."]

[node name="BeatIndicatorUI" type="Control" parent="UILayer"]
anchor_right = 1.0
margin_bottom = 42.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource( 9 )
__meta__ = {
"_edit_use_anchors_": false
}
beat_manager_node = NodePath("../../BeatManager")

[node name="TextureRect" type="TextureRect" parent="UILayer/BeatIndicatorUI"]
margin_left = 72.0
margin_top = 64.0
margin_right = 104.0
margin_bottom = 96.0
rect_min_size = Vector2( 32, 32 )
texture = ExtResource( 8 )
expand = true
__meta__ = {
"_edit_use_anchors_": false
}

[node name="InputChainUI" type="Node2D" parent="UILayer"]
position = Vector2( 104, 168 )
script = ExtResource( 12 )
input_manager_node = NodePath("../../InputManager")

[node name="NotificationUI" type="Control" parent="UILayer"]
anchor_right = 1.0
anchor_bottom = 1.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Tasks" type="Control" parent="UILayer/NotificationUI"]
margin_right = 40.0
margin_bottom = 40.0

[node name="Messages" type="Control" parent="UILayer/NotificationUI"]
margin_right = 40.0
margin_bottom = 40.0
__meta__ = {
"_edit_use_anchors_": false
}
[connection signal="body_entered" from="Bystanders/Group/Area" to="Bystanders/Group" method="_on_Area_body_entered"]
[connection signal="body_exited" from="Bystanders/Group/Area" to="Bystanders/Group" method="_on_Area_body_exited"]
[connection signal="finished" from="BeatManager/AudioStreamPlayer" to="BeatManager" method="_on_AudioStreamPlayer_finished"]
